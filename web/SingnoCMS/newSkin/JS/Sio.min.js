/*
 * Sio v11.02
 * Date: 2011-2
 * (c) 2011 Singno, http://www.Singno.com
 */
function $i(a){return document.getElementById(a)}function $t(a){return document.getElementsByTagName(a)}function $it(a,b){return document.getElementById(a).getElementsByTagName(b)}function $ce(a){return document.createElement(a)}function $ct(a){return document.createTextNode(a)}function $QC(a){var b=(typeof a=='string')?Sio.get(a):a;return(b.length)?b:[b]}function $CI(a){return(typeof a=='string')?$i(a):a}var Sio={version:'11.02',create:function(d,a,h){var b=$ce(d);if(a)Sio.attr(b,a);if(h)b.innerHTML=h;return b},get:function(k){if(document.querySelectorAll){return document.querySelectorAll(k)}else{var l=k.split(','),m=[],n=[];Sio.each(l,function(i,c){if(c.indexOf('#')==0&&c.indexOf(' ')>0){var a=c.split(' '),b=a[0].substring(1),d=a[1];if(d.indexOf('>')>0){var e=d.split('>'),f=Sio.filter('',e[0],'tag');for(var x=1,y=e.length;x<y;x++){f=Sio.filter(f,e[x],'son')}n=f}else{if(d.indexOf('.')>-1){var g=d.split('.'),h=(g[0])?$it(b,g[0]):$it(b,'div');n=Sio.filter(h,g[1],'class')}else if(d.indexOf('[')>-1){var j=d.split('[');n=Sio.filter($it(b,j[0]),j[1].replace(']',''),'attr')}else{n=$it(b,d)}}}else if(c.indexOf('>')>0){var e=c.split('>'),f=Sio.filter('',e[0],'tag');for(var x=1,y=e.length;x<y;x++){f=Sio.filter(f,e[x],'son')}n=f}else{n=Sio.filter('',c,'tag')}m=Sio.conn(m,n)});return m}},onload:function(a){if(document.addEventListener){document.addEventListener("DOMContentLoaded",a,false)}else{var b=false,c=function(){if(!b){b=true;a()}};(function(){try{document.documentElement.doScroll('left')}catch(e){setTimeout(arguments.callee,50);return}c()})();document.onreadystatechange=function(){if(document.readyState=='complete'){document.onreadystatechange=null;c()}}}},filter:function(a,b,c){var d=[];switch(c){case'tag':if(a){if(b.indexOf('.')>=0){var f=[],g=b.split('.');Sio.each(a,function(i,e){if(e.nodeName.toLowerCase()==g[0])f.push(e)});d=Sio.filter(f,g[1],'class')}else if(b.indexOf('[')>-1){var h=b.split('[')[1];d=Sio.filter(a,h.substring(0,h.length-1),'attr')}else{var f=[],k=b.split('.')[0];Sio.each(a,function(i,e){if(e.nodeName.toLowerCase()==k)f.push(e)});d=f}}else{if(b.indexOf('#')==0){d=[$i(b.substring(1))]}else if(b.indexOf('.')>-1){var g=b.split('.'),m=(g[0])?$t(g[0]):$t('div');d=Sio.filter(m,g[1],'class')}else if(b.indexOf('[')>-1){var h=b.split('[');d=Sio.filter($t(h[0]),h[1].replace(']',''),'attr')}else{d=$t(b)}}return d;break;case'son':Sio.each(a,function(i,e){Sio.each(e.children,function(n){d.push(e.children[n])})});return(b)?Sio.filter(d,b,'tag'):d;break;case'class':Sio.each(a,function(i,e){if(Sio.hasClass(e,b))d.push(e)});return d;break;case'attr':var p=b.replace(']','').split('='),q=p[0],r=p[1];if(a.length){Sio.each(a,function(i,e){if(e.getAttribute(q)==r)d.push(e)})}return d;break}},children:function(o,s){var a=$QC(o);return Sio.filter(a,s,'son')},next:function(o,s){var b=$QC(o),c=[];Sio.each(b,function(i,a){a=a.nextSibling;while(a&&a.nodeType==1){c.push(a);a=a.nextSibling}});return(s)?Sio.filter(c,s,'tag'):c},prev:function(o,s){var b=$QC(o),c=[];Sio.each(b,function(i,a){a=a.previousSibling;while(a&&a.nodeType==1){c.push(a);a=a.previousSibling}});return(s)?Sio.filter(c,s,'tag'):c},siblings:function(o,s){var b=$QC(o),c=[];Sio.each(b,function(n,a){Sio.each(a.parentNode.children,function(i,e){if(e!=a)c.push(e)})});return(s)?Sio.filter(c,s,'tag'):c},remove:function(o){var a=$QC(o);Sio.each(a,function(i,e){e.parentNode.removeChild(e)})},empty:function(o){var a=$QC(o);Sio.each(a,function(i,e){Sio.each(e.children,function(){e.removeChild(e.children[0])})})},html:function(o,h){var a=$QC(o);Sio.each(a,function(i,e){e.innerHTML=h})},text:function(o,t){var a=$QC(o);Sio.each(a,function(i,e){e.innerText=t})},attr:function(o,c){var b=$QC(o),d=[];Sio.each(b,function(i,e){d=c.split(';');Sio.each(d,function(n,r){if(r){var a=r.split(':');(a[0]=='class'||a[0]=='className')?e.className=a[1]:e.setAttribute(a[0],a[1])}})})},val:function(o,v){var a=$QC(o);Sio.each(a,function(i,e){e.setAttribute('value',v)})},before:function(o,e){var b=$QC(o);Sio.each(b,function(i,a){a.parentNode.insertBefore(e.cloneNode(true),a)})},after:function(o,e){var b=$QC(o);Sio.each(b,function(i,a){a.parentNode.insertBefore(e.cloneNode(true),a.nextSibling)})},wrap:function(o,e){var c=$QC(o);Sio.each(c,function(i,a){var b=e.cloneNode(true);if(a.parentNode)a.parentNode.insertBefore(b,a);b.appendChild(a)})},wrapInner:function(o,e){var c=$QC(o);Sio.each(c,function(i,a){var b=e.cloneNode(true);Sio.each(a.children,function(){if(a.children[0])b.appendChild(a.children[0])});a.appendChild(b)})},css:function(o,c){var d=$QC(o),e;if(c.indexOf(':')>=0){Sio.each(d,function(i,o){if(c.indexOf('opacity')>-1){var a=/opacity:.+;/,b=parseFloat(c.match(a)[0].split(':')[1].replace(/;/,''));o.style.cssText=c.replace(a,'');Sio.opacity(o,b)}else{o.style.cssText=c}})}else{if(c=="opacity"){return Sio.opacity(d[0])}else{if(document.all){c=c.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()});return d[0].currentStyle[c]}else{return document.defaultView.getComputedStyle(d[0],null).getPropertyValue(c)}}}},width:function(o,c){var a=$QC(o);if(c!=undefined){Sio.each(a,function(i,e){e.style.width=c+'px'})}else{return parseInt(Sio.css(a[0],'width'))}},height:function(o,c){var a=$QC(o);if(c!=undefined){Sio.each(a,function(i,e){e.style.height=c+'px'})}else{return parseInt(Sio.css(a[0],'height'))}},addClass:function(o,c){var a=$QC(o);Sio.each(a,function(i,e){if(!Sio.hasClass(o,e))e.className+=' '+c})},removeClass:function(o,c){var a=$QC(o);Sio.each(a,function(i,e){e.className=e.className.replace(c,'')})},hoverClass:function(o,c){var a=$QC(o);Sio.each(a,function(i,e){e.onmouseover=function(){Sio.addClass(this,c)};e.onmouseout=function(){Sio.removeClass(this,c)}})},toggleClass:function(o,c){var a=$QC(o);Sio.each(a,function(i,e){(Sio.hasClass(e,c))?Sio.removeClass(e,c):Sio.addClass(e,c)})},display:function(o,a){var b=$QC(o);val=(a)?'block':'none';if(o&&a!=undefined){Sio.each(b,function(i,e){e.style.display=val})}},getPos:function(o){o=$CI(o);var l,t;if(o.getBoundingClientRect){var a=o.getBoundingClientRect(),b=document.documentElement,c=document.body,d=Math.max(b.scrollTop,c.scrollTop);sl=Math.max(b.scrollLeft,c.scrollLeft);l=sl+a.left;t=d+a.top}else{l=o.offsetLeft;t=o.offsetTop;while(o=o.offsetParent){l+=o.offsetLeft;t+=o.offsetTop}}return{x:l,y:t}},opacity:function(o,c){o=$CI(o);if(c){(o.filters)?o.style.filter="alpha(opacity="+c*100+")":o.style.opacity=c}else{return(document.all&&o.style.filter)?parseFloat(o.style.filter.match(/opacity=.+/)[0].replace(/\)/,'').split('=')[1]/100):parseFloat(o.style.opacity)||100}},hasClass:function(o,c){o=$CI(o);if(!o.length)return((' '+o.className+' ').indexOf(' '+c+' ')>-1)},addEvent:function(a,b,c){var d=$QC(a);Sio.each(d,function(i,e){e['on'+b]=function(){c(this)}})},removeEvent:function(a,b){var c=$QC(a);Sio.each(c,function(i,e){e['on'+b]=null})},getEvent:function(e){return e?e:window.event},getTarget:function(e){return e?e.target:event.srcElement},stopBubble:function(e){(e&&e.stopPropagation)?e.stopPropagation():event.cancelBubble=true},stopDefault:function(e){(e&&e.preventDefault)?e.preventDefault():event.returnValue=false},contains:function(o,t){o=$CI(o);return Sio.text(o).indexOf(t)>=0},each:function(a,b){for(var i=0,l=a.length;i<l;i++){b(i,a[i])}},isArray:function(o){return Object.prototype.toString.call(o)==='[object Array]'},trim:function(a){return a.toString().replace(/(^\s*)|(\s*$)/gm,'')},conn:function(a,b){Sio.each(b,function(i,e){a.push(e)});return a},index:function(a,o){var i=-1;Sio.each(a,function(n,e){if(o==e)i=n});return i},param:function(o){var s=[];for(var i in o){s.push(i+'='+o[i])}return s.join('&')},serialize:function(b){var c=$i(b),d=[];Sio.each(c.elements,function(i,e){switch(e.type){case'select-one':case'select-multiple':Sio.each(e,function(j,o){if(o.selected){var a=(o.hasAttribue)?(o.hasAttribute('value')?o.value:o.text):(o.attributes['value']?o.value:o.text);d.push(encodeURIComponent(e.name)+'='+encodeURIComponent(a))}});break;case undefined:case'file':case'submit':case'reset':case'button':break;case'radio':case'checkbox':if(!e.checked){break};default:d.push(encodeURIComponent(e.name)+'='+encodeURIComponent(e.value))}});return d.join('&')},setCookie:function(a,b){var c=30,d=new Date();d.setTime(d.getTime()+c*24*60*60*1000);document.cookie=a+"="+escape(b)+";expires="+d.toGMTString()},getCookie:function(a){var b=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)"));if(b!=null)return unescape(b[2]);return null},delCookie:function(a){var b=new Date();b.setTime(b.getTime()-1);var c=getCookie(a);if(c!=null)document.cookie=a+"="+c+";expires="+b.toGMTString()},ajax:function(c){var d=c.url,f=c.method||'get',g=c.complete||function(){},h=c.error||function(){},j=c.sync||true,k=c.data;function createXHR(){var a=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject('MSXML2.XMLHTTP')},function(){return new ActiveXObject('MSXML3.XMLHTTP')},function(){return new ActiveXObject('Microsoft.XMLHTTP')}],b;Sio.each(a,function(i,e){try{b=e()}catch(e){}});return b}var l=createXHR();l.onreadystatechange=function(){if(l.readyState==4){var a=l.status;((a>=200&&a<300)||a==304)?g(l.responseText):h()}};l.open(f,d,j);if(f=='post'){l.setRequestHeader('Content-Type','application/x-www-form-urlencoded');l.send((typeof k=='string')?k:Sio.param(k))}else{l.send(null)}}};Sio.BS=function(){var a=navigator.userAgent.toLowerCase();function check(r){return r.test(a)}var b=check(/opera/),c=check(/version.*safari/),d=check(/chrome/),e=check(/gecko/)&&!check(/webkit/),f=!!document.all,g=f&&!window.XMLHttpRequest,h=f&&check(/msie 7/),i=f&&check(/msie 8/);Sio.BS=function(){return{OP:b,SA:c,CH:d,FF:e,IE:f,IE7:h,IE8:i,IE6:g}};return Sio.BS()};Sio.Text=function(a){var b=((a)?'#'+a+' ':''),c=Sio.get(b+'input[type=text],'+b+'input[type=password],'+b+'textarea');if(c.length){Sio.addClass(c,'S_input_text');if(Sio.BS().IE6)Sio.hoverClass(c,'S_input_text_hover');Sio.addEvent(c,'focus',function(e){e.select();Sio.addClass(e,'S_focus')});Sio.addEvent(c,'blur',function(e){Sio.removeClass(e,'S_focus')})}};Sio.Button=function(b){var b=(b)?'#'+b+' ':'',d=Sio.get(b+'input[type=button],'+b+'input[type=submit],'+b+'input[type=reset]'),f='down',g='S_buttonOuter',h='S_buttonOuter_hover';if(Sio.BS().IE){Sio.each(d,function(i,e){e.className='S_button';if(e.parentNode.parentNode.className.indexOf(g)<0){var a=Sio.create('span','class:'+g,'<span class="S_buttonInner"></span>');e.parentNode.insertBefore(a,e);a.children[0].appendChild(e);a.onmousedown=function(){Sio.addClass(this,f)};a.onmouseup=function(){Sio.removeClass(this,f)};a.onmouseout=function(){Sio.removeClass(this,f)};if(Sio.BS().IE6){a.onmouseover=function(){Sio.addClass(this,h)};a.onmouseout=function(){Sio.removeClass(this,h);Sio.removeClass(this,f)}}}})}else{Sio.each(d,function(i,e){e.className='S_button'})}};Sio.AjaxForm=function(a){var b=a.id,c=a.method||'post',d=a.complete||function(){},f=a.error||function(){},g=$i(b),h,i=Sio.get('#'+b+' input[type=submit],#'+b+' button[type=submit],#'+b+' input[type=image]');Sio.addEvent(i,'click',function(e){Sio.stopDefault(e);h=Sio.serialize(b);Sio.ajax({url:g.action,method:c,data:h,complete:function(){g.reset();d()},error:function(){f()}})})};Sio.Tree=function(r){var s=this.id=r.id||'',t=this.width=r.width||'auto',u=this.height=r.height||'auto',v=this.data=r.data||[],w=this.edited=r.edited||false,x=this.renderTo=r.renderTo,y=this.fn=r.fn,z=this.url=r.url||'images/Plugin',A='',B='',C=(x)?$i(x):document.body,D={folder:z+'/folder.gif',folderOpen:z+'/folderopen.gif',node:z+'/page.gif',empty:z+'/empty.gif',nlPlus:z+'/nolines_plus.gif',nlMinus:z+'/nolines_minus.gif'},E='switch_cmd';function xNode(a,b,c,d,e){var a=a||'',b=b||'',d=d||'',c=c,e=e||false,m='',n='',o='',p=(e)?'<input type="checkbox" name="" id="" />':'',q=[];if(c.length>1){for(var i=0,l=c.length-1;i<l;i++){q.push('<img src="'+D.empty+'" alt="" />')}m=q.join('')}else{m=''};(d=='folder')&&(n='<img class="'+E+'" src="'+D.nlPlus+'" alt="" />');(d=='node')&&(n='<img class="'+E+'" src="'+D.nlMinus+'" alt="" />');o='<img src="'+D[d]+'" alt="" />';if(c.length==1){n='<img class="'+E+'" src="'+D.nlMinus+'" alt="" />';o='<img src="'+D.folderOpen+'" alt="" />'};return'<div class="listItem"><span class="listItemFl">'+m+n+o+'</span>'+p+'<span class="listItemFl" UrlData="'+b+'">'+a+'</span>'}function getNodes(a,b){var c='',d=[];Sio.each(b,function(i,e){a.pop();a.push(i);c=(e.nodes)?'folder':'node';d.push('<li Level="'+a.join('_')+'">'+xNode(e.text,e.urlData,a,c,w)+'</li>')});return d.join('')}A='<li Level="0">'+xNode(v[0].text,v[0].urlData,[0],'folder',w)+'</li>';B=getNodes([0,1],v[0].nodes);this.render=function(){var a=Sio.create('div','id:'+s+';class:S_tree_list'),b=Sio.create('ul','',A+B);a.appendChild(b);a.style.width=(t=='auto')?'auto':t+'px';a.style.height=(u=='auto')?'auto':u+'px';(x)?$i(x).appendChild(a):document.body.appendChild(a)};function bindEvent(l,o,p){if(Sio.BS().IE6)hoverNode(o);openNode(l);clickFn(l,p);if(w)checkedFn();function hoverNode(a){var b=[];Sio.each(a,function(i,e){b.push(e.firstChild)});Sio.hoverClass(b,'listItem_hover')}function clickFn(a,b){var c=[];Sio.each(a,function(i,e){c.push((w)?e.parentNode.nextSibling.nextSibling:e.parentNode.nextSibling)});Sio.addEvent(c,'click',function(e){b(e.getAttribute('UrlData'))})}function checkedFn(){var a=Sio.get('#'+s+' input[type=checkbox]');Sio.addEvent(a,'click',function(e){F();e.parentNode.className=(e.checked)?'listItem listItem_select':'listItem'})}function openNode(k){Sio.each(k,function(n,m){m.onclick=function(){if(!this.parentNode.parentNode.nextSibling){if(this.nextSibling.src.indexOf('folder')>0&&this.parentNode.parentNode.parentNode.getAttribute('Level')!='0'){this.src=D.nlMinus;this.nextSibling.src=D.folderOpen;var a=$ce('ul'),b=this.parentNode.parentNode.parentNode,c=b.getAttribute('Level').split('_'),d=v;Sio.each(c,function(i,e){d=d[e].nodes});c.push(0);a.innerHTML=getNodes(c,d);b.appendChild(a);var f=this.parentNode.parentNode.nextSibling;f.id='S_currentUL';var g=f.children,h=Sio.get('#S_currentUL img.'+E);f.id='';if(Sio.BS().IE6)hoverNode(g);openNode(h);clickFn(h,p);if(w)checkedFn()}}else{this.src=D.nlPlus;this.nextSibling.src=D.folderOpen;var j=this.parentNode.parentNode.nextSibling;if(j.style.display=='none'){this.src=D.nlMinus;this.nextSibling.src=D.folderOpen;j.style.display='block'}else{this.src=D.nlPlus;this.nextSibling.src=D.folder;j.style.display='none'}}}})}}this.checked=function(){var a=Sio.get('#'+s+' input[type=checkbox]'),b=[];Sio.each(a,function(i,e){if(e.checked)b.push(e.nextSibling.getAttribute('UrlData'))});return b};var F=this.checked;this.render();var G=Sio.get('#'+s+' img.'+E),H=$it(s,'li');bindEvent(G,H,y)};Sio.Dragdrop=function(p){var q=$QC(p.target),r=p.handle,s=document.body,t=document.documentElement,u=p.dir||'',v=p.range,w=p.opacity,x=p.start,y=p.dragging||function(){},z=p.complete;Sio.each(q,function(i,e){if(r){if(r.indexOf('#')>=0){r=Sio.get(hanndle)}else{var k=(e.id)?e.id:'S_DragHandler';r=Sio.get('#'+k+' '+r)}}else{r=[e]}var l=e.offsetWidth,m=e.offsetHeight;if(!u&&!v)v=[0,t.clientWidth,0,t.scrollHeight+m];Sio.each(r,function(n,o){o.onmousedown=function(d){var f=Sio.BS().FF;if(x)x();s.onselectstart=function(){return false};if(w)Sio.opacity(e,w);var g=s.scrollLeft,h=s.scrollTop,i=(f)?d.layerX:event.offsetX-((g)?g:t.scrollLeft),j=(f)?d.layerY:event.offsetY-((h)?h:t.scrollTop);if(u=='x'){t.onmousemove=function(a){var b=((f)?a.pageX:event.clientX)-i;if(b>=v[0]&&b<=v[1]-l)e.style.left=b+'px';y(b)}}else if(u=='y'){t.onmousemove=function(a){var b=((f)?a.pageY:event.clientY)-j;if(b>=v[0]&&b<=v[1]-m)e.style.top=b+'px';y(b)}}else{t.onmousemove=function(a){var b=((f)?a.pageX:event.clientX)-i,c=((f)?a.pageY:event.clientY)-j;if(b>=v[0]&&b<=v[1]-l)e.style.left=b+'px';if(c>=v[2]&&c<=v[3]-m)e.style.top=c+'px';y([b,c])}}};o.onmouseup=function(){if(w)Sio.opacity(e,100);s.onselectstart=null;t.onmousemove=null;if(z)z()}})})};Sio.Slider=function(b){var c=this.id=b.id,d=this.renderTo=b.renderTo,e=this.dragging=b.dragging,f=this.complete=b.complete,g=this.width=b.width||200,h=this.value=b.value||100,i='<div class="S_sliderTooltip"></div><div class="S_x_slider"></div>',j=Sio.create('div','class:S_Slider;id:'+c,i),k=j.children[0],l=j.children[1];Sio.width(j,g);((d)?$i(this.renderTo):document.body).appendChild(j);var m=Sio.getPos(c).x,n=m+g,o=Sio.get('#'+c+'>div.S_x_slider'),p=n-k.offsetWidth/2-o[0].offsetWidth,q=g-o[0].offsetWidth;this.setValue=function(a){if(a>=0&&a<=100)l.style.left=m+g*(a/100)+'px'};this.setValue(h);Sio.Dragdrop({target:o,dir:'x',range:[m,n],start:function(){k.style.display='block';k.style.left=g*(h/100)+m+'px';k.innerHTML=h},dragging:function(a){if(a>=m&&a<=p){k.style.left=a+'px';k.innerHTML=Math.round((a-m)/q*100);h=k.innerHTML;if(e)e(h)}},complete:function(){k.style.display='none';if(f)f(h)}});this.getValue=function(){return Math.round(h)}};Sio.Tabs=function(a){if(a){var b=a.tab||'S_Tab',c=a.con||'S_Con',d=a.evt||'click',f=a.value||0}else{var b='S_Tab',c='S_Con',d='click'}var $tabLi=Sio.get('#'+b+'>ul>li'),g=Sio.get('#'+c+'>ul>li'),h=f;Sio.addClass($tabLi[h],'curr');Sio.display(g,false);g[h].style.display='block';Sio.addEvent($tabLi,d,function(e){Sio.removeClass($tabLi[h],'curr');g[h].style.display='none';h=Sio.index($tabLi,e);Sio.addClass(e,'curr');g[h].style.display='block'})};Sio.Alert=function(d){if(!$i('S_XAlert')){var e=d.width||400,f=d.height||240,g=d.mask||true,h=d.title||'',i=d.type||'',j=d.button,k=d.text||'',l=d.okFn,m=d.closeFn,n='',o=$t('select'),p=document.body,q=document.documentElement;switch(i){case'':n='<iframe id=S_XAlertFrame name=S_XAlertFrame frameborder=0 scrolling=auto></iframe>';break;case'alert':n='<div class=frameAlert>'+k+'</div>';break;case'success':n='<div class=frameSuccess>'+k+'</div>';break;case'fail':n='<div class=frameFail>'+k+'</div>';break;case'text':n='<div class=frameText>'+k+'</div>';break};if(!i){var r=d.src||'',s=d.args||'',t=''}if(j==undefined)j=true;if(g){var u=Sio.create('div','id:S_alertMask');p.appendChild(u);var v=function(){Sio.width(u,q.clientWidth);Sio.height(u,q.scrollHeight)};v();};if(o.length)Sio.css(o,'visibility:hidden;');var w=(j)?'<div class=btmDiv><input id=ok_cmd type=button value=确定 /><input id=cancel_cmd type=button value=取消 /></div>':'',x=Sio.create('div','id:S_XAlert','<div class=titleBar><div class=left></div><div class=center></div><div class=close_cmd><div id=close_cmd></div></div><div class=right></div></div><div class=content><div class=frame>'+n+'</div>'+w+'</div>');var y=x.firstChild,z=y.children[1],A=y.children[2].firstChild,B=x.lastChild,C=B.firstChild;Sio.width(x,e);Sio.height(x,f);x.style.left=(q.clientWidth-e)/2+'px';x.style.top=(q.clientHeight-f)/2+'px';y.style.width=e+'px';z.style.width=e-35+'px';B.style.height=f-28+'px';C.style.height=f-((j)?63:28)+'px';if(!i){var D=C.firstChild;Sio.width(D,e-2);Sio.height(D,f-((j)?63:28));D.src=r}z.innerText=h;if(Sio.BS().IE6)Sio.hoverClass(A,'hover');p.appendChild(x);Sio.Dragdrop({target:'#S_XAlert',handle:'div.titleBar'});if(!i)window.frames['S_XAlertFrame'].dialogArguments=s;x.onclick=function(a){var b=Sio.getTarget(a).id;if(b=='close_cmd'||b=='cancel_cmd'){closeAlert();if(m)m()}else if(b=='ok_cmd'){var c=(i)?'':window.frames['S_XAlertFrame'].SioReturnValue;closeAlert();if(l)l(c)}};function closeAlert(){if(o.length)Sio.css(o,'visibility:visible;');if(g)p.removeChild($i('S_alertMask'));p.removeChild(x)};Sio.Button('S_XAlert')}};Sio.ProgressBar=function(c){var d=this.id=c.id||'S_ProgressBar',e=this.width=c.width||300,f=this.height=c.height||30,g=this.renderTo=c.renderTo||'',h=this.value=c.value||0,i=this.complete=c.complete;if(!$i(d)){var j='<div class="PB_top"></div><div class="PB_middle"><div class="PB_Slider"></div></div><div class="PB_bottom"></div><div class="PB_Slider1"><div></div></div><div class="PB_Slider2"><div></div></div>',k=Sio.create('div','class:S_ProgressBar;id:'+d,j);var l=k.children,m=l[1],n=m.children[0],o=k.children[3],p=k.children[4],q=o.children[0],r=p.children[0];var s=-(f/2+7)+'px',t=(e/2-10)+'px',u=e-2,v=f-4;Sio.width(k,e);Sio.height(k,f);l[0].style.width=u+'px';Sio.width(m,e-4);Sio.height(m,v);n.style.height=v+'px';l[2].style.width=u+'px';Sio.css(o,'width:'+e+'px;margin-top:'+s);p.style.marginTop=s;Sio.css([q,r],'padding-left:'+t);(g)?$i(g).appendChild(k):document.body.appendChild(k);this.setValue=function(a){if(e&&e>4){var b=e*(a/100);if(a>0)n.style.width=(b>4)?(b-4)+'px':'1px';Sio.html([q,r],a+'%');r.parentNode.style.width=(b>2)?(b-2)+'px':'1px'}if(a==100)i(a)};this.setValue(h)}};function createInputCmd(a,b,c,d,e,f,g){var h=Sio.create('div','id:'+a+c+';class:'+d,'<input id="'+a+'" name="'+a+'" type="text" value=""/><div></div>'),i=h.children[0],j=h.children[1];i.value=f||'';j.setAttribute(g.name,g.value);$i(b).appendChild(h);var k=parseInt(Sio.width(j)),l=parseInt(Sio.css(i,'border-left-width'))+parseInt(Sio.css(i,'border-right-width')),m=parseInt(Sio.css(i,'padding-left'))+parseInt(Sio.css(i,'padding-right')),n=parseInt(Sio.css(i,'margin-left'))+parseInt(Sio.css(i,'margin-right'));h.style.width=e+'px';i.style.width=e-l-m-n-k+'px'}Sio.Calendar=function(f){var g=this.id=f.id,h=this.renderTo=f.renderTo,k=this.width=f.width||150,l=this.value=f.value,n=this.addTime=f.addTime||false,o=this.format=f.format||1,p=this.daySplit=f.daySplit||'-',q=this.timeSplit=f.timeSplit||':',r=this.complete=f.complete,t=this.align=f.align,u,v,w,x,z,A,B,C,D,E=['一','二','三','四','五','六','七','八','九','十','十一','十二',];createInputCmd(g,h,'S_CalendarInput','S_Calendar',k,l,{name:'formatData',value:o+'_'+p+'_'+q+'_'+n+'_'+(!!r?1:0)+'_'+t});if(!$i('S_Calendar')){var F='',G='',H='',I='';for(var i=0;i<6;i++){F+='<tr>';for(var j=1;j<=7;j++)F+="<td></td>";F+="</tr>"}G='<div id="S_Calendar_year"><div class="top"><div id="S_prevYearList" class="arrow_left"></div><div class="cent"><span id="S_startYear"></span>-<span id="S_endYear"></span></div><div id="S_nextYearList" class="arrow_right"></div></div><div id="S_yearList"><ul></ul></div></div>';H='<div id="S_Calendar_month"><ul></ul></div></div>';I='<div id="S_CalendarC"><div class="top"><div id="S_prevMonth" class="arrow_left" title="上月"></div><div class="cent"><span id="S_year"></span>-<span id="S_month"></span></div><div id="S_nextMonth" class="arrow_right" title="下月"></div></div><div class="middle"><table cellspacing="0" cellpadding="0"><thead><tr><tr><td>日</td><td>一</td><td>二</td><td>三</td><td>四</td><td>五</td><td>六</td></tr></thead><tbody id="S_Calendar_tbody">'+F+'</tbody></table></div><div class="bottom"><div id="S_showTime" class="time"><span id="S_hour"></span> : <span id="S_minute"></span> : <span id="S_second"></span></div><div class="cmd" id="S_clearDay">清空</div><div id="S_today" class="cmd">今天</div><div class="cmd" id="S_backDay">返回</div></div>';var J=Sio.create('div','id:S_Calendar',I+G+H);document.body.appendChild(J)}var K=Sio.get('.S_Calendar>div'),L=$i('S_Calendar'),M=$i('S_hour'),N=$i('S_minute'),O=$i('S_second'),P=$i('S_Calendar_month'),Q=$i('S_Calendar_year'),R=$i('S_backDay'),S=Sio.get('#S_Calendar_tbody>tr>td');if(Sio.BS().IE6){Sio.hoverClass(K,'calHover');Sio.hoverClass('#S_CalendarC div.top>div.arrow_left,#S_CalendarC div.top>div.arrow_right','arrow_hover');Sio.hoverClass('#S_CalendarC>div.top>div.cent>span','hover');Sio.hoverClass('#S_CalendarC>div.bottom>div.cmd','cmd_hover')}L.onclick=function(e){var a=Sio.getTarget(e).id;switch(a){case'S_year':showYear();break;case'S_month':showMonth();break;case'S_backDay':closeYearMonth();break;case'S_today':getNow();break;case'S_clearDay':closeDay();cInput.value='';break;case'S_prevYearList':reYearList(D-20);break;case'S_nextYearList':reYearList(D+20);break;case'S_prevMonth':reCalendar(v,w-1);break;case'S_nextMonth':reCalendar(v,w+1);break}};$i('S_Calendar_tbody').onclick=function(e){var a=Sio.getTarget(e);if(a.className.indexOf('day')>-1||a.className.indexOf('curr')>-1)seTime(parseInt(a.innerHTML))};Q.onclick=function(e){var a=Sio.getTarget(e);if(a.nodeName=='LI'){reCalendar(parseInt(a.innerHTML),w);closeYearMonth()}};P.onclick=function(e){var a=Sio.getTarget(e);if(a.nodeName=='LI'){reCalendar(v,parseInt(a.title));closeYearMonth()}};Sio.Text(g+'S_CalendarInput');Sio.addEvent(K,'click',function(e){cInput=e.previousSibling;if(!Sio.hasClass(e,'colorDown')){Sio.removeClass(K,'colorDown');e.className='colorDown';A=new Date();B=A.getFullYear();C=A.getMonth();reCalendar(B,C);var a=Sio.getPos(cInput),b=e.getAttribute('formatData').split('_');o=parseInt(b[0]);p=b[1];q=b[2];n=(b[3]=='true')?true:false;u=(b[4]=='1')?true:false;t=b[5];if(t=='right'){a.x=a.x-(213-k)}Sio.css(L,'display:block;left:'+a.x+'px;top:'+(a.y+parseInt(cInput.offsetHeight))+'px');if(n){M.innerHTML=addZero(A.getHours());N.innerHTML=addZero(A.getMinutes());O.innerHTML=addZero(Math.round(A.getTime()%60000/1000));$i('S_showTime').style.display='block'}else{$i('S_showTime').style.display='none'}}else{closeDay()}});function reCalendar(y,m){var a=new Date(y,m,1),b=a.getDay()-1;v=a.getFullYear();w=a.getMonth();ss=a.getTime();$i("S_year").innerHTML=v;$i("S_month").innerHTML=w+1>9?(w+1):'0'+(w+1);var c=countDays(v,w),d=b+c;for(var i=0;i<42;i++){var e=S[i];if(i>b&&i<=d){e.innerHTML=i-b;e.className='day';if(a.getFullYear()==B&&a.getMonth()==C&&parseInt(e.innerHTML)==A.getDate())e.className='curr'}else{e.innerHTML='';e.className=''}}if(Sio.BS().IE6){Sio.hoverClass('#S_Calendar_tbody td.day','day_hover')}}function showYear(){reYearList(2000);Sio.display([Q,R],true)}function reYearList(a){D=a;var b=D+19,c=[];for(var i=D;i<=b;i++){c.push('<li '+((A.getFullYear()==i)?'class="curr"':'')+'>'+i+'</li>')}$i('S_yearList').children[0].innerHTML=c.join('');$i('S_startYear').innerHTML=D;$i('S_endYear').innerHTML=b;if(Sio.BS().IE6){Sio.hoverClass($it('S_yearList','li'),'hover')}}function showMonth(){var a=[];for(var i=0;i<12;i++){a.push('<li '+((A.getMonth()==i)?'class="curr"':'')+' title="'+i+'">'+E[i]+'月</li>')}P.children[0].innerHTML=a.join('');Sio.display([P,R],true);if(Sio.BS().IE6){Sio.hoverClass($it('S_Calendar_month','li'),'hover')}}function countDays(a,b){var c=new Array(31,28,31,30,31,30,31,31,30,31,30,31);return(b==1)?(((0==a%4)&&(0!=(a%100)))||(0==a%400)?29:28):c[b]}function seTime(d){var a='',b=addZero(w+1),c=addZero(d),e=(n?' '+addZero(M.innerHTML)+q+addZero(N.innerHTML)+q+addZero(O.innerHTML):'');switch(o){case 1:a=v+p+b+p+c+e;break;case 2:a=c+p+b+p+v+e;break;case 3:a=b+p+c+p+v+e;break;case 4:a=b+p+c+e;break;case 5:a=v+p+b+e;break;case 6:a=b+p+v+e;break};cInput.value=a;if(u)r(a);closeDay()}function addZero(s){var s=parseFloat(s.toString().replace(/(^[\s0]+)|(\s+$)/g,''));s=isNaN(s)?0:s;return(s<10?'0':'')+s.toString()}function getNow(){var a=new Date();v=a.getFullYear();w=(a.getMonth()+1>9?a.getMonth():"0"+a.getMonth());ss=(a.getTime()+1>9?a.getTime()+1:"0"+a.getTime());seTime(a.getDate());closeDay()}function closeYearMonth(){Sio.display([Q,P,R],false)}function closeDay(){closeYearMonth();Sio.removeClass(K,'colorDown');L.style.display='none'}};Sio.ColorPicker=function(c){var d=this.id=c.id,f=this.renderTo=c.renderTo,g=this.width=c.width||120,h=this.value=c.value,j=this.align=c.align,k=this.complete=c.complete,l,m=['C00000','FF0000','FFC000','FFFF00','92D050','00B050','00B0F0','0070C0','002060','7030A0'],p=[['F2F2F2','D8D8D8','BFBFBF','A5A5A5','7F7F7F'],['7F7F7F','595959','3F3F3F','262626','0C0C0C'],['DDD9C3','C4BD97','938953','494429','1D1B10'],['C6D9F0','8DB3E2','548DD4','17365D','0F243E'],['DBE5F1','B8CCE4','95B3D7','366092','244061'],['F2DCDB','E5B9B7','D99694','953734','632423'],['EBF1DD','D7E3BC','C3D69B','76923C','4F6128'],['E5E0EC','CCC1D9','B2A2C7','5F497A','3F3151'],['DBEEF3','B7DDE8','92CDDC','31859B','205867'],['FDEADA','FBD5B5','FAC08F','E36C09','974806']],q=[],r=[],s='';createInputCmd(d,f,'ColorPicker','S_colorPickerCon',g,h,{name:'callbackData',value:(!!k?1:0)+'_'+j});if(!$i('S_colorPickerPanel')){var t='<div class="S_colorInput"><div class="colorShow"><div></div></div></div>';Sio.each(m,function(i,e){q.push('<div class=S_color_h_border title="#'+e+'"><div style="background:#'+e+'"></div></div>')});Sio.each(p,function(i,e){var a=[];Sio.each(e,function(n,o){a.push('<div title="#'+o+'" style="background:#'+o+'"></div>')});r.push('<div class=S_color_list>'+a.join('')+'</div>')});var u=Sio.create('div','id:S_colorPickerPanel;class:S_colorPickerPanel',t+'<div class="S_colorContent">'+q.join('')+r.join('')+'</div>');document.body.appendChild(u)}var v=$i('S_colorPickerPanel'),w=Sio.get('.S_colorPickerCon>div'),x=v.children[0].children[0].children[0],y=v.children[1],z=Sio.children(y,'div.S_color_h_border'),A=Sio.children(y,'div.S_color_list'),B=Sio.children(A);if(Sio.BS().IE6)Sio.hoverClass(w,'colorHover');Sio.addEvent(z,'mouseover',function(e){Sio.addClass(e,'S_color_h_border_hover');x.style.background=e.title;s=e.title});Sio.addEvent(z,'mouseout',function(e){Sio.removeClass(e,'S_color_h_border_hover')});Sio.addEvent(z,'click',function(e){setColor()});Sio.addEvent(B,'mouseover',function(e){Sio.addClass(e,'S_color_list_hover');x.style.background=e.title;s=e.title});Sio.addEvent(B,'mouseout',function(e){Sio.removeClass(e,'S_color_list_hover')});Sio.addEvent(B,'click',function(e){setColor()});Sio.Text(d+'ColorPicker');Sio.addEvent(w,'click',function(e){cInput=e.previousSibling;if(!Sio.hasClass(e,'colorDown')){Sio.removeClass(w,'colorDown');e.className='colorDown';var a=Sio.getPos(cInput);var b=e.getAttribute('callbackData').split('_');l=b[0]=='1'?true:false;j=b[1];if(j=='right'){a.x=a.x-(178-g)}Sio.css(v,'display:block;left:'+a.x+'px;top:'+(a.y+parseInt(cInput.offsetHeight))+'px')}else{Sio.removeClass(w,'colorDown');v.style.display='none'}});function setColor(){cInput.value=s;if(l)k(s);Sio.removeClass(w,'colorDown');v.style.display='none'}};
